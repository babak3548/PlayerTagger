using System;
using System.Runtime.InteropServices;

namespace VideoEditor.Join
{
    public class SMM_Defs
    {

        public const string IID_ITrimmerObjControlCB = "33968711-8887-46D4-A71B-9B1B061EEDCA";
        public const string IID_ITrimmerObjControl = "9D9BF96C-8E7A-41FC-ABB1-CCC9CEF493E9";
        public const string LIBID_AVITRIMMERCOMLib = "958BB6C7-14FB-49EF-AFAE-678155680C6A";
        public const string CLSID_TrimmerObjControl = "B61C3708-CAA8-48CA-9D9C-682D0A5A3852";
        public const string CLSID_VideoEditingSDK = "7750A708-3EEB-45b9-8179-077689D77E33";
        //---------------------------------------------------------------------------------
        public const string SMAT_InputFile = "04890910-6B0B-465D-B507-2568710565FD";
        public const string SMAT_OutputFile = "b45c2624-07e5-4905-A1A5-23DDD26EFC13";
        public const string SMAT_Flags = "AAF40DFF-0698-4424-87DC-3B1E2D60CDD8";
        public const string SMAT_ResetFlag = "19F90CB9-A5EA-4821-A8BA-AD6FB9422B9C";
        public const string SMAT_CurrentSize = "12258211-7D2F-4373-84C7-B755A8A40DD9";
        public const string SMAT_TrimList = "C1D0F958-4489-4322-80CD-898089A220C1";
        public const string SMAT_Progress = "AE82DE01-D84B-4EE5-90AA-052B108C4380";
        public const string SMAT_AudioStreamNumber = "5EB26970-133F-4AD1-BE21-A849618CA8F3";
        public const string SMAT_VideoStreamNumber = "D9898809-5987-4EBC-967D-C595465923A1";
        public const string SMAT_Callback = "DA1ED33F-9EF4-4c98-BCA5-66FF917FFCBE";
        public const string SMAT_GetVersions = "BD62FD5E-B517-4f8f-976E-5FA1ACE4F9DC";
        public const string SMAT_BatchFileName = "909605C1-F9CE-4360-9AFA-0BAE16E95784";
        public const string SMAT_CurrentBatchTask = "7AF7B8FE-FA2F-44f2-915E-D668EE32E8A6";
        public const string SMAT_BatchTasksNum = "102C7E6B-2112-4a52-BD2B-1E80DF137699";
        public const string SMAT_StreamLength = "D206760E-C900-4A94-BB3D-4C1998BBE120";
        public const string SMAT_SetAutoSplittingMode = "EC9B5486-F1C9-4d51-B240-D6355BA2E2F5";
        public const string SMAT_SetAutoSplittingValue = "2DC69654-929E-46e9-B0CC-6B33D5AAB4C3";
        public const string SMAT_GetProcessingPartNumber = "BE0064CB-5172-4fc9-A07E-305FB1FC2EF5";
        public const string SMAT_OutputType = "3F20F1D6-1132-4e28-AB6B-ED94700C2949";
        public const string SMAT_SilentPath = "2e83b26b-65b3-4609-95b5-e918a96ae151";
        public const string SMAT_MPEG2IndexFileName = "1ade47b6-bb44-4820-a077-6116f861775b";
        public const string SMAT_CodecsSet = "17B25796-46AB-44a6-BBF4-9A3A160E63FB";
        public const string SMAT_TaskType = "a5e6000d-52d9-4f41-9091-11c4fdae990b";
        public const string SMAT_TrackInfo = "FA8BD847-4DC6-492d-9585-E86654CDAC1F";
        public const string SMAT_TrimAccuracy = "4B07D80A-0FA6-4d69-8438-159CB1BC749F";
        public const string SMAT_OutIndexFile = "534D4154-5F46-696C-6554-6F496E646578";
        public const string SMAT_StartIndexation = "534D4154-5f53-7461-7274-496e64657861";
        public const string SMAT_GetFileType = "534D4154-5F47-6574-4669-6C6554797065";
        public const string SMAT_ValidateFiles = "534D4154-5661-6C69-6461-746546696C65";
        public const string SMAT_ASFMarkersCount = "0b9c6ab5-f968-46a8-85e1-09fa8b8a734b";
        public const string SMAT_ASFMarkerRemove = "72825bb9-b725-456a-8e2c-d650acdfb674";
        public const string SMAT_ASFMarker = "c022a53f-ce3d-4c03-baed-11fcc7ccded2";
        public const string SMAT_ActionKey = "6DB8381C-2D6D-4904-8333-C693E9BC3F68";
        public const string SMAT_InterpretInputType = "556C6493-CB43-4a35-B3EC-733F41B29FD9";

        public const string g_ActionKey_Join = "BC342AC510A3DD6697019CA8901B7F1ECFA25F3285801F10FDE815E6830BC3387740137005ADCCD77479067BA2BDBDB6360454BFEE64A4BB518AB6AFCF47F442074E16A4777C44BB4B45FE3E176B67D459C7AC621942FA5F9B" +
"3E7E77BB4D6E2BA2CFE073E352023BEA4DB00D5914E1466A6C2F73534533676DD930567A3AF836074E16A4777C44BB2D81F1A3B009AD6E3F16E2ACDB70651778F7196DC33CE9B6C20F3FF8CEA62180CD1A450CBE8841D4074E" +
"16A4777C44BB110C332D082FE3E3591653EDBC16C74F79121FD58DA68D408B579933EE69794DB511C7AC078D50440A29803E10ADD2CC51D589660F5D3C6B25B7ED16F9AFFDF37E45228D0704030E0801BBEC0D631B04E08781" +
"34317A5F976DC57B3EE0E0CA39D0EDD6123397B0BBE07518D536E5801D5BFAAB8D0CB0E8EECD1A450CBE8841D4074E16A4777C44BB935F4D6E792283D64A0983EA6E5EC53A5BFAAB8D0CB0E8EECD1A450CBE8841D4074E16A4" +
"777C44BB935F4D6E792283D6BFE0F6248301AED45BFAAB8D0CB0E8EECD1A450CBE8841D4074E16A4777C44BB935F4D6E792283D6D1B2A2FA72C1D18F591653EDBC16C74F79121FD58DA68D408B579933EE69794DB511C7AC07" +
"8D50444C70D083B59BEF3E9C6AD18FD56563F5E0878134317A5F976DC57B3EE0E0CA39D0EDD6123397B0BB3E0B7701DBA0294CD1B2A2FA72C1D18F591653EDBC16C74F79121FD58DA68D408B579933EE69794D6C0A94A9151C" +
"BA7FCABDD2C6CD623B84F3E71992AFAF623D51D589660F5D3C6B25B7ED16F9AFFDF348C62F1A6950BF26C7202B890B04180ACD98DD99F73AFB8C5E680DA498C7BABBEB9C6865C020B3D518990C004D04DD44366ECB0150A98B" +
"314AE86A6700F4801459E563548C3B2EAA25B7ED16F9AFFDF3E1381CAC16C542DD522D7FD01E8D5C9B0B0A9D59E294E0286AA2476CD56B5B32E0878134317A5F976DC57B3EE0E0CA39D0EDD6123397B0BB40D023D85BB9BD4F" +
"5BFAAB8D0CB0E8EECD1A450CBE8841D4074E16A4777C44BB5FF7D27702A0BD50591653EDBC16C74F79121FD58DA68D408B579933EE69794D6C0A94A9151CBA7FE2BACFBFC3BC32F051D589660F5D3C6B25B7ED16F9AFFDF37E" +
"45228D0704030E33BE14C1F71816E6E0878134317A5F976DC57B3EE0E0CA39D0EDD6123397B0BB24234C5FC85452AF5BFAAB8D0CB0E8EECD1A450CBE8841D4074E16A4777C44BB935F4D6E792283D64A0983EA6E5EC53A5BFA" +
"AB8D0CB0E8EECD1A450CBE8841D4074E16A4777C44BB935F4D6E792283D6BFE0F6248301AED45BFAAB8D0CB0E8EECD1A450CBE8841D4074E16A4777C44BB935F4D6E792283D6D1B2A2FA72C1D18F591653EDBC16C74F79121F" +
"D58DA68D408B579933EE69794DB511C7AC078D50444C70D083B59BEF3E9C6AD18FD56563F5E0878134317A5F976DC57B3EE0E0CA39D0EDD6123397B0BB3E0B7701DBA0294CD1B2A2FA72C1D18F591653EDBC16C74F79121FD5" +
"8DA68D408B579933EE69794D985C6D92222A58B461E692B1497E0E2151D589660F5D3C6B25B7ED16F9AFFDF37E45228D0704030EFD39B7CD11A0D4B308DC724B64900B74E0878134317A5F976DC57B3EE0E0CA39D0EDD61233" +
"97B0BB65ACE7FDEF950EF4DDB1A1249479706F591653EDBC16C74F929B80A4A6AD57EE6A6C2F7353453367F6FD5E5ADC4CD5A6EB9C6865C020B3D518990C004D04DD44A9D66D9359BC445CD0EDD6123397B0BB2C13655793CB" +
"37C4C20F3FF8CEA62180CD1A450CBE8841D4074E16A4777C44BB110C332D082FE3E3591653EDBC16C74F79121FD58DA68D408B579933EE69794DB511C7AC078D50440A29803E10ADD2CC51D589660F5D3C6B25B7ED16F9AFFD" +
"F37E45228D0704030E0801BBEC0D631B04E0878134317A5F976DC57B3EE0E0CA39D0EDD6123397B0BBE07518D536E5801D5BFAAB8D0CB0E8EECD1A450CBE8841D4074E16A4777C44BB6CFD4A8D3470318A591653EDBC16C74F" +
"79121FD58DA68D408B579933EE69794DB511C7AC078D5044063927EA9AA06A84591653EDBC16C74F79121FD58DA68D408B579933EE69794DB511C7AC078D504434553C19C44D4CE9591653EDBC16C74F79121FD58DA68D408B" +
"579933EE69794DB511C7AC078D5044778C4F893C58A432F3E71992AFAF623D51D589660F5D3C6B25B7ED16F9AFFDF348C62F1A6950BF26461799A4D9A58F66850246732C1CA2EB5BFAAB8D0CB0E8EECD1A450CBE8841D4074E" +
"16A4777C44BB935F4D6E792283D666586E1674DB9D16F3E71992AFAF623D51D589660F5D3C6B25B7ED16F9AFFDF315D06A0182A8839E5B369D286986AFC3E0878134317A5F976DC57B3EE0E0CA39D0EDD6123397B0BB937C32" +
"A8FC3C7B9221C8129B39921FFD5BFAAB8D0CB0E8EECD1A450CBE8841D4074E16A4777C44BB1A009A85149F7E9544B259FFF38751EFA8ADD88C17931376F4F6BB8B5FD0B0295E688D937F9A8B407B3589609B641552F4EAC99A" +
"19985677BBF750315266F37860BA164CC8A75237A73CFA1C2DCE9C4A";

        public enum SMM_OutputTypes
        {
            SMM_File_Type_NO = 0,
            SMM_File_Type_AVI,          // audio video interleaving format
            SMM_File_Type_ASF,          // advanced streaming format
            SMM_File_Type_MPA,          // mpeg audio
            SMM_File_Type_MPEG2_PS,     // MPEG-2 Program Stream
            SMM_File_Type_MPEG2_TS,     // MPEG-2 Transpot Stream
            SMM_File_Type_MPEG2_VES,	// MPEG-2 Video Elementary Stream
            SMM_File_Type_MPEG1_SYS,	// MPEG-1 System stream. Unsupported
            SMM_File_Type_MPEG1_VES,	// MPEG-1 Video only elementary stream.
            SMM_File_Type_WAV,			// WAVE audio steam
            SMM_File_Type_MPEG4_AVC,	// MPEG-4 AVC Video only elementary stream.
            SMM_File_Type_MKV,			// Matroska video
            SMM_File_Type_MP4,			// MPEG-4 Part 14 - MP4 File format
            SMM_File_Type_RAW,
            SMM_File_Type_FLV,
            SMM_File_Type_COUNT // all formats count

        }

        public enum SMM_TaskType
        {
            SMM_Task_Type_Trimming = 0x0,
            SMM_Task_Type_Joining = 0x1,
            SMM_Task_Type_Indexation = 0x5
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct TrimInfoList
        {
            public int nListSize;
            public IntPtr trim_list;
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct __TSTrimInfo
        {
            public Int16 nPieceNum;				// Piece number in general sequences
            public Int64 llStartPos;				// Time offset of start trim position
            public Int64 llStopPos;				// Time offset of stop trim position
        }

        [StructLayout(LayoutKind.Sequential, Size = 2172, CharSet = CharSet.Unicode)]
        public struct SMM_TRACK_INFO
        {
            public Int32 nVideoStream;
            public Int32 nAudioStream;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 1024)]
            public string szMPEG2IdxFileName;
            public Int32 nClips;
            public IntPtr pClips;
            public Int32 nOutType;
            public Int32 nTrimmAccurType;
            public UInt32 ulFlags;
            public Int32 dwASMode;
            public Int64 llASValue;
            public UInt32 nTrackPos;
            public Int32 nTextStream;
            public Int32 compatibility;
            [MarshalAs(UnmanagedType.ByValArray, SizeConst = 18)]
            public UInt32[] dwReserv;
        }

        [StructLayout(LayoutKind.Sequential, Size = 2160, CharSet = CharSet.Unicode)]
        public struct SMM_CLIP_INFO
        {
            public Int32 dwClipNum;
            public Int64 rtStart;
            public Int64 rtEnd;
            public Int32 bMute;
            [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 1024)]
            public string wsfName;
            public Int32 positionStart;
            public Int32 positionEnd;
            [MarshalAs(UnmanagedType.ByValArray, SizeConst = 18)]
            public UInt32[] dwReserv;
        }

        public static string[] XTLDescr_TrackOutType = { "no type", "avi", "asf", "mpa", "mpg_ps", "mpg_ts", "mpg_ves", "mpg1_sys", "mpg1_ves", "wav", "avc_ves", "matroska", "mp4", "raw", "flv" };

        public enum SMM_InterpretInputType
        {
            SMM_InterpretInputType_Original = 0,
            SMM_InterpretInputType_GeoVision
        }
    }
}
